<!DOCTYPE html>
<html>
  <head>
   <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="styling.css">
  </head>
   <body>
    <!-- Navigation Panel Begin -->
    <span id="topBar" onclick="openNav()">Select Month &#9776;</span>
     <div id="navPanel" class="sidenav">
      <a href="javascript:void(0)" class="closebtn" onclick="closeNav()"> &times;</a>
      <a href="January.html">January</a>
      <a href="February.html">February</a>
      <a href="March.html">March</a>
      <a href="April.html">April</a>
      <a href="May.html">May</a>
      <a href="June.html">June</a>
      <a href="July.html">July</a>
      <a href="August.html">August</a>
      <a href="September.html">September</a>
      <a href="October.html">October</a>
      <a href="November.html">November</a>
      <a href="December.html">December</a>
     </div>
    <div id="main"></div>
    <!-- Navigation Side Panel End -->

    <!-- Chart Panel Begin -->
    <span id="chartBar" onclick="openChartNav()">View Chart &emsp;&#9776;</span>
     <div id="chartPanel" class="chartNav">
      <a href="javascript:void(0)" class="closeChartBtn" onclick="closeChartNav()"> &times;</a>
      <div id="columnchart_material" style="padding-left: 10px; width: 800px; height: 500px;"></div>
     </div>
    <div id="main"></div>
    <!-- Chart Side Panel End -->

    <!-- Quick Stats Panel Begin -->
    <span id="quickBar" onclick="openQuickWindow()">Quick Stats &emsp;&#9776;</span>
     <div id="quickPanel" class="quickWindow">
      <a href="javascript:void(0)" class="closePanelBtn" onclick="closeQuickWindow()"> &times;</a>
      <iframe src="quickStats.html" style="border:none; width: 95%; height: 95%; frameborder: 0;"></iframe>
     </div>
    <div id="main"></div>
    <!-- Quick Stats Side Panel End -->

    <div id="legend"><p></p><h3>Legend</h3></div>

    <!-- Map Begin -->
    <div id="map"></div>
    <!-- Map End -->

   </body>

    <!-- Cluster Map -->
    <script src="markerclusterer.js"></script>
    <!-- Google Maps -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCC2ZcP0KnGMAtrqXlwvqSZXWz-OhbaQEo&callback=createMap" async defer></script>
    <!-- Chart -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <!-- All script -->
    <script type="text/javascript">

    // Chart Section Begin
    google.charts.load('current', {'packages':['bar']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
     var data = google.visualization.arrayToDataTable([["Accidents for December", "Traffic Accident", "Traffic Accident - DUI / DUID", "Traffic Accident - Fatality", "Traffic Accident - Hit and Run", "Traffic Accident - Police", "Traffic Accident - Serious Bodily Injury", { role: "annotation" } ],
['2012', 1182, 73, 5, 569, 15, 20, '1864'],
['2013', 1299, 61, 4, 496, 24, 29, '1913'],
['2014', 1412, 80, 4, 435, 19, 29, '1979'],
['2015', 1364, 67, 3, 492, 24, 25, '1975'],
['2016', 1382, 65, 2, 567, 17, 27, '2060'],
['2017', , , , , , , ''],
]);

     var options = {
      isStacked: false,
      bar: {groupWidth: "90%"},
      backgroundColor: 'none',
      width: 700,
      height: 300,
      fontSize: "14",
	hAxis: {gridlines: {count: 200,},},
      chart: {
       title: 'Denver Traffic Accidents by Year',
       subtitle: 'From City of Denver Open Data Catalog 2012-2017',
        fontSize: "10",
      }
     };

     var chart = new google.charts.Bar(document.getElementById('columnchart_material'));

     chart.draw(data, google.charts.Bar.convertOptions(options));
    }
    // Chart Section End

   // Navigation Panel Script Begin
   function openNav() {
    document.getElementById("navPanel").style.width = "150px";
   }

   function closeNav() {
    document.getElementById("navPanel").style.width = "0";
   }
   // Navigation Panel Script End

   // Chart Panel Script Begin
   function openChartNav() {
    document.getElementById("chartPanel").style.width = "720px";
   }

   function closeChartNav() {
    document.getElementById("chartPanel").style.width = "0";
   }
   // Chart Panel Script End

   // Quick Stats Panel Script Begin
   function openQuickWindow() {
    document.getElementById("quickPanel").style.width = "720px";
   }

   function closeQuickWindow() {
    document.getElementById("quickPanel").style.width = "0";
   }
   // Quick Stats Panel Script End

   // Map Options
   function createMap() {
    var denver = {lat: 39.730157, lng: -104.984694};
    var mapOptions = {
     zoom: 12,
     center: denver,
     disableDefaultUI: true,
     zoomControl: true
    }
    var map = new google.maps.Map(document.getElementById('map'), mapOptions);
    // Map Options End

    // Map title and caption begin
     var infoTitle = document.createElement('h2');
      infoTitle.style.color = '#2C3E50';
              infoTitle.innerHTML = 'Denver Accidents December, 2016';

     var infoText = document.createElement('div');
      infoText.appendChild(infoTitle);

     var infoCaption = document.createElement('h3');
      infoCaption.style.color = 'gray';
      infoCaption.innerHTML =
       '<div id="content">'+
       'Map generated from <a href="http://data.denvergov.org">'+
       'City of Denver Open Data Catalog<a> '+
       'Data licensed under '+
       '<a href="http://creativecommons.org/licenses/by/3.0/">'+
       'CC BY 3.0<a> - Map generated by '+
       '<a href="https://www.osullivan-law-firm.com/">'+
       'The O\'Sullivan Law Firm<a></a> '+
       '</div>';

     var infoCaptionText = document.createElement('div');
      infoCaptionText.appendChild(infoCaption);

     // Push the title and caption to the page
     map.controls[google.maps.ControlPosition.TOP_CENTER].push(infoText);
     map.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(infoCaption);
     // Map title and caption end

     // Legend Box Begin
     var legend = document.getElementById('legend');
      var div = document.createElement('div');
       legend.appendChild(div);
        div.innerHTML =
         '<p><img src="images/m0.png" style="width:14px;height:14px;line-height: 10%;"> Single Incident</p>'+
         '<p><img src="images/m1.png" style="width:15px;height:15px;line-height: 10%;"> Small Concentration</p>'+
         '<p><img src="images/m2.png" style="width:16px;height:16px;line-height: 10%;"> Medium Concentration</p>'+
         '<p><img src="images/m3.png" style="width:17px;height:17px;line-height: 10%;"> Large Concentration</p>'+
         '<p><img src="images/m4.png" style="width:18px;height:18px;line-height: 10%;"> Very Large Concentration</p>'+
         '<p><img src="images/m5.png" style="width:19px;height:19px;line-height: 10%;"> Extremely Large Concentration</p>';
     map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(legend);
     // Legend Box End

     // Create the infowindow variable
     var infowindow = new google.maps.InfoWindow();

     // O'Sullivan Marker Begin
     var osullivanInfo =
      '<div id="content">'+
      '<font color="black">'+
      '</div>'+
      '<h1 id="firstHeading" class="firstHeading">The O\'Sullivan Law Firm</h1>'+
      '<div id="bodyContent">'+
      '<p>Address: 600 N Ogden St, Denver, CO 80218</p>'+
      '<p>Phone: (303)388-5304</p>'+
      '<p>Website: <a href="https://www.osullivan-law-firm.com/">'+
      'www.osullivan-law-firm.com</a> '+
      '</p>'+
      '</div>';

     var infowindow1 = new google.maps.InfoWindow({
      content: osullivanInfo,
     });

     var osullivan = new google.maps.Marker({
      position: {lat:39.725731, lng:-104.974952},
      map: map,
      icon: 'images/osullivan.png'
     });

     osullivan.addListener('click', function() {
      infowindow1.open(map, osullivan);
     });
     // O'Sullivan Marker End

     // Create individual data layers and apply individual properties
     // Accident layer begin
     var accidentLayer = new google.maps.Data();
      accidentLayer.loadGeoJson('https://andrewrussette.github.io/nineThirtyOne/html/December.json', null, function (features) {
      accidentLayer.setStyle({visible: false});

      var accidents = features.map(function (feature) {
       var geo = feature.getGeometry();
       var marker = new google.maps.Marker({
        position: geo.get(0),
        icon: 'images/a3.png',
        label: '1',
       });
       return marker;
      });
      var markerCluster = new MarkerClusterer(map, accidents,{ imagePath: 'images/m' });
      });
     // Accident layer end

     // Ridepoint layer begin
     var ridepointLayer = new google.maps.Data();
      ridepointLayer.loadGeoJson('https://andrewrussette.github.io/nineThirtyOne/html/ridePoints.json');
      ridepointLayer.setStyle(function(feature) {
       return {icon:feature.getProperty('icon')};
      });

      // When the user clicks, open an infowindow
      ridepointLayer.addListener('click', function(event) {
       var infoTag = event.feature.getProperty("name");
       infowindow.setContent("<div style='color: black;'>"+infoTag+"</div>");
       // position the infowindow on the marker
       infowindow.setPosition(event.feature.getGeometry().get());
       // anchor the infowindow on the marker
       infowindow.setOptions({pixelOffset: new google.maps.Size(0,-10)});
       infowindow.open(map);
      });
      // Ridepoint layer end

      // Bring up the maps for each layer
      accidentLayer.setMap(map, infowindow);
      ridepointLayer.setMap(map, infowindow);

}
// Turn on the map
createMap();

    </script>

</html>